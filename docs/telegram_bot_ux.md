# AI Artist Platform - Telegram Bot User Experience (v1.4)

This document outlines the user experience (UX) for interacting with the AI Artist Platform via its Telegram bot interface. As of v1.4, the primary interaction revolves around the manual approval/rejection workflow for content generated by the `batch_runner` when an artist is *not* in Autopilot mode.

## Core Workflow: Content Approval

1.  **Generation Cycle Trigger:** The `batch_runner` selects an artist (not in Autopilot mode) and initiates a content generation cycle (music, visuals, reflection).
2.  **Preview Notification:** Upon successful generation of the core assets (e.g., track preview, video preview), the `batch_runner` calls the `telegram_service`.
3.  **Telegram Message:** The `telegram_service` sends a message to the configured `TELEGRAM_CHAT_ID`. This message includes:
    *   **Artist Information:** Name and ID of the artist.
    *   **Run ID:** The unique identifier for this specific generation run.
    *   **Content Preview:** Typically includes:
        *   A text caption summarizing the run (Artist, Run ID, Track URL, Video URL, A/B Test info if applicable).
        *   Attached media files (e.g., a short audio clip, a preview image/video snippet) if available and configured.
    *   **Action Buttons:** Inline keyboard buttons labeled "Approve" and "Reject".
4.  **User Action:** The user reviews the preview message and clicks either the "Approve" or "Reject" button.
5.  **Callback Handling (External):**
    *   *(Assumption/Requirement):* An external webhook server (not part of this core repository in v1.4) receives the callback query from Telegram when a button is pressed.
    *   This webhook server is responsible for identifying the `run_id` associated with the button press (likely encoded in the callback data).
    *   The webhook server updates the corresponding run status file (e.g., `/home/ubuntu/ai_artist_system_clone/output/run_status/{run_id}.json`) by changing the `status` field to `"approved"` or `"rejected"`.
6.  **Batch Runner Polling:** The `batch_runner`, which has been waiting (polling the status file at intervals defined by `BATCH_RUNNER_WAIT_INTERVAL_SECONDS`), detects the status change in the JSON file.
7.  **Workflow Continuation:**
    *   **If Approved:** The `batch_runner` proceeds with the next steps, typically involving the `release_chain` to package the content.
    *   **If Rejected:** The `batch_runner` logs the rejection, potentially updates artist performance metrics (future enhancement), and concludes the cycle for this run.

## Commands (Current - v1.4)

*   **No direct user commands** are implemented for controlling the batch runner or system via the bot in v1.4. The interaction is purely reactive to the approval/rejection buttons sent by the system.
*   *(Note: The planned Telegram Control Panel Interface, which would have included commands like `/status`, `/start_run`, `/toggle_autopilot`, was skipped during development due to technical challenges.)*

## User Experience Considerations

*   **Clarity:** The preview message should clearly identify the artist, run, and provide sufficient context for the user to make an informed decision.
*   **Responsiveness:** The time between generation completion and the Telegram preview appearing should be minimal. The polling interval in the batch runner determines how quickly it reacts to the user's approval/rejection.
*   **Feedback:** The bot currently provides implicit feedback (the batch runner proceeds or stops). Explicit confirmation messages (e.g., "Run {run_id} approved/rejected") could be added to the webhook server logic for a better UX.
*   **Error Handling:** If the webhook server fails to update the status file, the batch runner will eventually time out (based on `BATCH_RUNNER_MAX_WAIT_TIME_SECONDS`) and mark the run as failed.

## Future Enhancements (Potential)

*   Implement the Control Panel Interface with commands for status checks, manual run triggers, etc.
*   Provide more detailed feedback messages upon approval/rejection.
*   Allow users to add comments or reasons for rejection via the bot.
*   Implement commands to manage artist settings (e.g., toggling Autopilot directly via Telegram).
